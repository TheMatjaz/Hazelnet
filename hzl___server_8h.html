<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hazelnet: inc/hzl_Server.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Hazelnet<span id="projectnumber">&#160;3.0.0</span>
   </div>
   <div id="projectbrief">Reference implementation of the CAN Bus Security (CBS) protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bfccd401955b95cf8c75461437045ac0.html">inc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">hzl_Server.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Hazelnet Server public API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="hzl_8h_source.html">hzl.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for hzl_Server.h:</div>
<div class="dyncontent">
<div class="center"><img src="hzl___server_8h__incl.png" border="0" usemap="#ainc_2hzl___server_8h" alt=""/></div>
<map name="ainc_2hzl___server_8h" id="ainc_2hzl___server_8h">
<area shape="rect" title="Hazelnet Server public API." alt="" coords="363,5,478,32"/>
<area shape="rect" href="hzl_8h.html" title="General public definitions used used by both the Hazelnet Server and Client." alt="" coords="395,80,446,107"/>
<area shape="rect" title=" " alt="" coords="5,155,71,181"/>
<area shape="rect" title=" " alt="" coords="95,155,170,181"/>
<area shape="rect" title=" " alt="" coords="194,155,263,181"/>
<area shape="rect" title=" " alt="" coords="288,155,353,181"/>
<area shape="rect" title=" " alt="" coords="377,155,464,181"/>
<area shape="rect" title=" " alt="" coords="488,155,580,181"/>
<area shape="rect" title=" " alt="" coords="605,155,674,181"/>
<area shape="rect" title=" " alt="" coords="698,155,759,181"/>
<area shape="rect" title=" " alt="" coords="783,155,847,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="hzl___server_8h__dep__incl.png" border="0" usemap="#ainc_2hzl___server_8hdep" alt=""/></div>
<map name="ainc_2hzl___server_8hdep" id="ainc_2hzl___server_8hdep">
<area shape="rect" title="Hazelnet Server public API." alt="" coords="15,5,129,32"/>
<area shape="rect" href="hzl___server_os_8h.html" title="Hazelnet Server public API, addon for Operating Systems." alt="" coords="5,80,139,107"/>
</map>
</div>
</div>
<p><a href="hzl___server_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhzl___server_config.html">hzl_ServerConfig</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server constant configuration.  <a href="structhzl___server_config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhzl___server_clients_config.html">hzl_ServerClientsConfig</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server constant per-Client configuration.  <a href="structhzl___server_clients_config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhzl___server_group_config.html">hzl_ServerGroupConfig</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server constant Group configuration.  <a href="structhzl___server_group_config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhzl___server_group_state.html">hzl_ServerGroupState</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server variable State.  <a href="structhzl___server_group_state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhzl___server_ctx.html">hzl_ServerCtx</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration and status of the HazelNet Server library.  <a href="structhzl___server_ctx.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa7854bfddbd347dbe645e93c74e77394"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#aa7854bfddbd347dbe645e93c74e77394">HZL_SERVER_MAX_AMOUNT_OF_CLIENTS</a>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:aa7854bfddbd347dbe645e93c74e77394"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum amount of Clients overall this Server supports.  <a href="hzl___server_8h.html#aa7854bfddbd347dbe645e93c74e77394">More...</a><br /></td></tr>
<tr class="separator:aa7854bfddbd347dbe645e93c74e77394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aac58ed8e9d461b1488d6e46a112416"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a7aac58ed8e9d461b1488d6e46a112416">HZL_SERVER_LARGEST_MAX_COUNTER_NONCE_DELAY</a>&#160;&#160;&#160;(1U &lt;&lt; 22U)</td></tr>
<tr class="memdesc:a7aac58ed8e9d461b1488d6e46a112416"><td class="mdescLeft">&#160;</td><td class="mdescRight">Largest Max-Counter-Nonce value allowed in the Server configuration.  <a href="hzl___server_8h.html#a7aac58ed8e9d461b1488d6e46a112416">More...</a><br /></td></tr>
<tr class="separator:a7aac58ed8e9d461b1488d6e46a112416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19f2882631fc0c6d6686a4844b8de9dc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a19f2882631fc0c6d6686a4844b8de9dc">HZL_SERVER_MAX_COUNTER_NONCE_UPPER_LIMIT</a>&#160;&#160;&#160;0xFFFF80U</td></tr>
<tr class="memdesc:a19f2882631fc0c6d6686a4844b8de9dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Largest Counter-Nonce-Upper-Limit value allowed in the Server configuration.  <a href="hzl___server_8h.html#a19f2882631fc0c6d6686a4844b8de9dc">More...</a><br /></td></tr>
<tr class="separator:a19f2882631fc0c6d6686a4844b8de9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a6977578e1e1eeec5f4c592d33c539780"><td class="memItemLeft" align="right" valign="top">typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a6977578e1e1eeec5f4c592d33c539780">hzl_ServerBitMap_t</a></td></tr>
<tr class="memdesc:a6977578e1e1eeec5f4c592d33c539780"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integer data type used for the bitmap of Clients that must support <a class="el" href="hzl___server_8h.html#aa7854bfddbd347dbe645e93c74e77394" title="Maximum amount of Clients overall this Server supports.">HZL_SERVER_MAX_AMOUNT_OF_CLIENTS</a> bits.  <a href="hzl___server_8h.html#a6977578e1e1eeec5f4c592d33c539780">More...</a><br /></td></tr>
<tr class="separator:a6977578e1e1eeec5f4c592d33c539780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb623f10deffe94f3eb7b4d6b30ce380"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structhzl___server_config.html">hzl_ServerConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#aeb623f10deffe94f3eb7b4d6b30ce380">hzl_ServerConfig_t</a></td></tr>
<tr class="memdesc:aeb623f10deffe94f3eb7b4d6b30ce380"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server constant configuration.  <a href="hzl___server_8h.html#aeb623f10deffe94f3eb7b4d6b30ce380">More...</a><br /></td></tr>
<tr class="separator:aeb623f10deffe94f3eb7b4d6b30ce380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3bb250ea956b9b6d88a8b1faf109b8"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structhzl___server_clients_config.html">hzl_ServerClientsConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a5e3bb250ea956b9b6d88a8b1faf109b8">hzl_ServerClientConfig_t</a></td></tr>
<tr class="memdesc:a5e3bb250ea956b9b6d88a8b1faf109b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server constant per-Client configuration.  <a href="hzl___server_8h.html#a5e3bb250ea956b9b6d88a8b1faf109b8">More...</a><br /></td></tr>
<tr class="separator:a5e3bb250ea956b9b6d88a8b1faf109b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e3a4c46577f72e0929313cf05edd9b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structhzl___server_group_config.html">hzl_ServerGroupConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a03e3a4c46577f72e0929313cf05edd9b">hzl_ServerGroupConfig_t</a></td></tr>
<tr class="memdesc:a03e3a4c46577f72e0929313cf05edd9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server constant Group configuration.  <a href="hzl___server_8h.html#a03e3a4c46577f72e0929313cf05edd9b">More...</a><br /></td></tr>
<tr class="separator:a03e3a4c46577f72e0929313cf05edd9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09451717cf530f151361e06b79efd57f"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structhzl___server_group_state.html">hzl_ServerGroupState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a09451717cf530f151361e06b79efd57f">hzl_ServerGroupState_t</a></td></tr>
<tr class="memdesc:a09451717cf530f151361e06b79efd57f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hazelnet Server variable State.  <a href="hzl___server_8h.html#a09451717cf530f151361e06b79efd57f">More...</a><br /></td></tr>
<tr class="separator:a09451717cf530f151361e06b79efd57f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a227238d51b4c16b337df65ea1fad1d0d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structhzl___server_ctx.html">hzl_ServerCtx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a></td></tr>
<tr class="memdesc:a227238d51b4c16b337df65ea1fad1d0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration and status of the HazelNet Server library.  <a href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">More...</a><br /></td></tr>
<tr class="separator:a227238d51b4c16b337df65ea1fad1d0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae757f6ecd9b4c3a8e3bdb921aa04353b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#ae757f6ecd9b4c3a8e3bdb921aa04353b">_Static_assert</a> (sizeof(<a class="el" href="hzl___server_8h.html#aeb623f10deffe94f3eb7b4d6b30ce380">hzl_ServerConfig_t</a>)==3, &quot;The size of the Server Config struct must be exactly 3 B&quot;)</td></tr>
<tr class="memdesc:ae757f6ecd9b4c3a8e3bdb921aa04353b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Double-checking the size of the hzl_ServerConfig_t struct to avoid unexpected paddings.  <a href="hzl___server_8h.html#ae757f6ecd9b4c3a8e3bdb921aa04353b">More...</a><br /></td></tr>
<tr class="separator:ae757f6ecd9b4c3a8e3bdb921aa04353b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d839eca06ad31b98b29361763b4a2be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a1d839eca06ad31b98b29361763b4a2be">_Static_assert</a> (sizeof(<a class="el" href="hzl___server_8h.html#a5e3bb250ea956b9b6d88a8b1faf109b8">hzl_ServerClientConfig_t</a>)==17, &quot;The size of the Server-side Client Config struct must be exactly 17 B&quot;)</td></tr>
<tr class="memdesc:a1d839eca06ad31b98b29361763b4a2be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Double-checking the size of the hzl_ServerClientConfig_t struct to avoid unexpected paddings.  <a href="hzl___server_8h.html#a1d839eca06ad31b98b29361763b4a2be">More...</a><br /></td></tr>
<tr class="separator:a1d839eca06ad31b98b29361763b4a2be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd427ed44971275f4201d32d15424681"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#afd427ed44971275f4201d32d15424681">_Static_assert</a> (sizeof(<a class="el" href="hzl___server_8h.html#a03e3a4c46577f72e0929313cf05edd9b">hzl_ServerGroupConfig_t</a>)==24, &quot;The size of the Server Group Config struct must be exactly 24 B&quot;)</td></tr>
<tr class="memdesc:afd427ed44971275f4201d32d15424681"><td class="mdescLeft">&#160;</td><td class="mdescRight">Double-checking the size of the hzl_ServerGroupConfig_t struct to avoid unexpected paddings.  <a href="hzl___server_8h.html#afd427ed44971275f4201d32d15424681">More...</a><br /></td></tr>
<tr class="separator:afd427ed44971275f4201d32d15424681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aacb935193864d26375eaf58895975a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a5aacb935193864d26375eaf58895975a">_Static_assert</a> (sizeof(<a class="el" href="hzl___server_8h.html#a09451717cf530f151361e06b79efd57f">hzl_ServerGroupState_t</a>)==52, &quot;The size of the Server Group State struct must be exactly 52 B&quot;)</td></tr>
<tr class="memdesc:a5aacb935193864d26375eaf58895975a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Double-checking the size of the hzl_ServerGroupState_t struct to avoid unexpected paddings.  <a href="hzl___server_8h.html#a5aacb935193864d26375eaf58895975a">More...</a><br /></td></tr>
<tr class="separator:a5aacb935193864d26375eaf58895975a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6c587771c0292cb38fa2d6835214606"><td class="memItemLeft" align="right" valign="top"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#ad6c587771c0292cb38fa2d6835214606">hzl_ServerInit</a> (<a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *ctx)</td></tr>
<tr class="memdesc:ad6c587771c0292cb38fa2d6835214606"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation of the Server.  <a href="hzl___server_8h.html#ad6c587771c0292cb38fa2d6835214606">More...</a><br /></td></tr>
<tr class="separator:ad6c587771c0292cb38fa2d6835214606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9bffd4349f880158021439c0d3e7e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a6f9bffd4349f880158021439c0d3e7e2">hzl_ServerDeInit</a> (<a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *ctx)</td></tr>
<tr class="memdesc:a6f9bffd4349f880158021439c0d3e7e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deinitialisation of the Server, securely clearing the state.  <a href="hzl___server_8h.html#a6f9bffd4349f880158021439c0d3e7e2">More...</a><br /></td></tr>
<tr class="separator:a6f9bffd4349f880158021439c0d3e7e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e5fb9ed6ac5a553682864970803bfb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#ae3e5fb9ed6ac5a553682864970803bfb">hzl_ServerBuildUnsecured</a> (<a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *unsecuredPdu, const <a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *ctx, const uint8_t *userData, size_t userDataLen, <a class="el" href="hzl_8h.html#a5141d0db3abd7f536c3e4c428b51a273">hzl_Gid_t</a> groupId)</td></tr>
<tr class="memdesc:ae3e5fb9ed6ac5a553682864970803bfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds an <b>unsecured</b> message in plaintext.  <a href="hzl___server_8h.html#ae3e5fb9ed6ac5a553682864970803bfb">More...</a><br /></td></tr>
<tr class="separator:ae3e5fb9ed6ac5a553682864970803bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86ad407a9d8e58dfe6f32e9eff4188f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a86ad407a9d8e58dfe6f32e9eff4188f3">hzl_ServerBuildSecuredFd</a> (<a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *securedPdu, <a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *ctx, const uint8_t *userData, size_t userDataLen, <a class="el" href="hzl_8h.html#a5141d0db3abd7f536c3e4c428b51a273">hzl_Gid_t</a> groupId)</td></tr>
<tr class="memdesc:a86ad407a9d8e58dfe6f32e9eff4188f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds a secured message, encrypted, authenticated and timely, only for the given group to be able to read.  <a href="hzl___server_8h.html#a86ad407a9d8e58dfe6f32e9eff4188f3">More...</a><br /></td></tr>
<tr class="separator:a86ad407a9d8e58dfe6f32e9eff4188f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ea102344d4a13318c430db13c076dd3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#a2ea102344d4a13318c430db13c076dd3">hzl_ServerProcessReceived</a> (<a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *reactionPdu, <a class="el" href="hzl_8h.html#a4e9184780d6e2bb480b7e0e4756517d7">hzl_RxSduMsg_t</a> *receivedUserData, <a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *ctx, const uint8_t *receivedPdu, size_t receivedPduLen, <a class="el" href="hzl_8h.html#a4d223ec636e15110f4bdfcc4eac20f91">hzl_CanId_t</a> receivedCanId)</td></tr>
<tr class="memdesc:a2ea102344d4a13318c430db13c076dd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates, unpacks and decrypts (if necessary) any received message, preparing an automatic response when required.  <a href="hzl___server_8h.html#a2ea102344d4a13318c430db13c076dd3">More...</a><br /></td></tr>
<tr class="separator:a2ea102344d4a13318c430db13c076dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcdeb8319fbe3b5368ca80293a995e95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hzl___server_8h.html#afcdeb8319fbe3b5368ca80293a995e95">hzl_ServerForceSessionRenewal</a> (<a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *renewalPdu, <a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *ctx, <a class="el" href="hzl_8h.html#a5141d0db3abd7f536c3e4c428b51a273">hzl_Gid_t</a> groupId)</td></tr>
<tr class="memdesc:afcdeb8319fbe3b5368ca80293a995e95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forcibly start a Session Renewal Phase, unless one is already ongoing or no Clients are currently enabled (have Requested the STK) to process the REN message.  <a href="hzl___server_8h.html#afcdeb8319fbe3b5368ca80293a995e95">More...</a><br /></td></tr>
<tr class="separator:afcdeb8319fbe3b5368ca80293a995e95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Hazelnet Server public API. </p>
<p >Hazelnet implements the CAN Bus Security (CBS) protocol, which secures the CAN FD traffic providing encryption, authenticity and freshness of the messages.</p>
<p >The user of the library must handle the physical transmission and reception manually as this library only handles the building of messages to transmit and processing of received messages. The internal library state keeps track of ongoing handshakes, timeouts and other events per each Group.</p>
<p >The intended usage of the library is listed in an example snippet in the readme. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa7854bfddbd347dbe645e93c74e77394" name="aa7854bfddbd347dbe645e93c74e77394"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7854bfddbd347dbe645e93c74e77394">&#9670;&nbsp;</a></span>HZL_SERVER_MAX_AMOUNT_OF_CLIENTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HZL_SERVER_MAX_AMOUNT_OF_CLIENTS&#160;&#160;&#160;32U</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum amount of Clients overall this Server supports. </p>
<p >At Context initialisation the amount of Clients in <a class="el" href="hzl___server_8h.html#aeb623f10deffe94f3eb7b4d6b30ce380" title="Hazelnet Server constant configuration.">hzl_ServerConfig_t</a> may be any value &lt;= this limit.</p>
<p >The per-Group configuration <a class="el" href="hzl___server_8h.html#a03e3a4c46577f72e0929313cf05edd9b" title="Hazelnet Server constant Group configuration.">hzl_ServerGroupConfig_t</a> contains a static-sized bitmap of Clients in it which is limited to 32 bits to spare memory. One bit is reserved for the Server. </p>

</div>
</div>
<a id="a7aac58ed8e9d461b1488d6e46a112416" name="a7aac58ed8e9d461b1488d6e46a112416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aac58ed8e9d461b1488d6e46a112416">&#9670;&nbsp;</a></span>HZL_SERVER_LARGEST_MAX_COUNTER_NONCE_DELAY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HZL_SERVER_LARGEST_MAX_COUNTER_NONCE_DELAY&#160;&#160;&#160;(1U &lt;&lt; 22U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Largest Max-Counter-Nonce value allowed in the Server configuration. </p>
<p >2^22 = 4'194'304. Unitless. </p>

</div>
</div>
<a id="a19f2882631fc0c6d6686a4844b8de9dc" name="a19f2882631fc0c6d6686a4844b8de9dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19f2882631fc0c6d6686a4844b8de9dc">&#9670;&nbsp;</a></span>HZL_SERVER_MAX_COUNTER_NONCE_UPPER_LIMIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HZL_SERVER_MAX_COUNTER_NONCE_UPPER_LIMIT&#160;&#160;&#160;0xFFFF80U</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Largest Counter-Nonce-Upper-Limit value allowed in the Server configuration. </p>
<p >2^24 - 2^7 = 16777088 = 0xFFFF80, i.e. 128 less than the counter nonce max. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a6977578e1e1eeec5f4c592d33c539780" name="a6977578e1e1eeec5f4c592d33c539780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6977578e1e1eeec5f4c592d33c539780">&#9670;&nbsp;</a></span>hzl_ServerBitMap_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint32_t <a class="el" href="hzl___server_8h.html#a6977578e1e1eeec5f4c592d33c539780">hzl_ServerBitMap_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Integer data type used for the bitmap of Clients that must support <a class="el" href="hzl___server_8h.html#aa7854bfddbd347dbe645e93c74e77394" title="Maximum amount of Clients overall this Server supports.">HZL_SERVER_MAX_AMOUNT_OF_CLIENTS</a> bits. </p>

</div>
</div>
<a id="aeb623f10deffe94f3eb7b4d6b30ce380" name="aeb623f10deffe94f3eb7b4d6b30ce380"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb623f10deffe94f3eb7b4d6b30ce380">&#9670;&nbsp;</a></span>hzl_ServerConfig_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structhzl___server_config.html">hzl_ServerConfig</a> <a class="el" href="hzl___server_8h.html#aeb623f10deffe94f3eb7b4d6b30ce380">hzl_ServerConfig_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hazelnet Server constant configuration. </p>
<p >Single instance on the Server. Initialised by the user, not modified by the Server. </p>

</div>
</div>
<a id="a5e3bb250ea956b9b6d88a8b1faf109b8" name="a5e3bb250ea956b9b6d88a8b1faf109b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3bb250ea956b9b6d88a8b1faf109b8">&#9670;&nbsp;</a></span>hzl_ServerClientConfig_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structhzl___server_clients_config.html">hzl_ServerClientsConfig</a> <a class="el" href="hzl___server_8h.html#a5e3bb250ea956b9b6d88a8b1faf109b8">hzl_ServerClientConfig_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hazelnet Server constant per-Client configuration. </p>
<p >Unique per Client, multiple instances on the Server. Initialised by the user, not modified by the Server. </p>

</div>
</div>
<a id="a03e3a4c46577f72e0929313cf05edd9b" name="a03e3a4c46577f72e0929313cf05edd9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e3a4c46577f72e0929313cf05edd9b">&#9670;&nbsp;</a></span>hzl_ServerGroupConfig_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structhzl___server_group_config.html">hzl_ServerGroupConfig</a> <a class="el" href="hzl___server_8h.html#a03e3a4c46577f72e0929313cf05edd9b">hzl_ServerGroupConfig_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hazelnet Server constant Group configuration. </p>
<p >Unique per Group, multiple instances on the Server. Initialised by the user, not modified by the Server. </p>

</div>
</div>
<a id="a09451717cf530f151361e06b79efd57f" name="a09451717cf530f151361e06b79efd57f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09451717cf530f151361e06b79efd57f">&#9670;&nbsp;</a></span>hzl_ServerGroupState_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structhzl___server_group_state.html">hzl_ServerGroupState</a> <a class="el" href="hzl___server_8h.html#a09451717cf530f151361e06b79efd57f">hzl_ServerGroupState_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hazelnet Server variable State. </p>
<p >Single instance per Group, multiple instances per Server. Initialised, modified, managed and cleared fully by the Server: the user MUST NOT touch its contents. </p>

</div>
</div>
<a id="a227238d51b4c16b337df65ea1fad1d0d" name="a227238d51b4c16b337df65ea1fad1d0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a227238d51b4c16b337df65ea1fad1d0d">&#9670;&nbsp;</a></span>hzl_ServerCtx_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structhzl___server_ctx.html">hzl_ServerCtx</a> <a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configuration and status of the HazelNet Server library. </p>
<p >Initialised by the user on embedded, loaded from file on an OS. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae757f6ecd9b4c3a8e3bdb921aa04353b" name="ae757f6ecd9b4c3a8e3bdb921aa04353b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae757f6ecd9b4c3a8e3bdb921aa04353b">&#9670;&nbsp;</a></span>_Static_assert() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Static_assert </td>
          <td>(</td>
          <td class="paramtype">sizeof(<a class="el" href="hzl___server_8h.html#aeb623f10deffe94f3eb7b4d6b30ce380">hzl_ServerConfig_t</a>)&#160;</td>
          <td class="paramname"> = <code>=3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;The size of the Server Config struct must be exactly 3 B&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Double-checking the size of the hzl_ServerConfig_t struct to avoid unexpected paddings. </p>

</div>
</div>
<a id="a1d839eca06ad31b98b29361763b4a2be" name="a1d839eca06ad31b98b29361763b4a2be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d839eca06ad31b98b29361763b4a2be">&#9670;&nbsp;</a></span>_Static_assert() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Static_assert </td>
          <td>(</td>
          <td class="paramtype">sizeof(<a class="el" href="hzl___server_8h.html#a5e3bb250ea956b9b6d88a8b1faf109b8">hzl_ServerClientConfig_t</a>)&#160;</td>
          <td class="paramname"> = <code>=17</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;The size of the Server-side Client Config struct must be exactly 17 B&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Double-checking the size of the hzl_ServerClientConfig_t struct to avoid unexpected paddings. </p>

</div>
</div>
<a id="afd427ed44971275f4201d32d15424681" name="afd427ed44971275f4201d32d15424681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd427ed44971275f4201d32d15424681">&#9670;&nbsp;</a></span>_Static_assert() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Static_assert </td>
          <td>(</td>
          <td class="paramtype">sizeof(<a class="el" href="hzl___server_8h.html#a03e3a4c46577f72e0929313cf05edd9b">hzl_ServerGroupConfig_t</a>)&#160;</td>
          <td class="paramname"> = <code>=24</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;The size of the Server Group Config struct must be exactly 24 B&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Double-checking the size of the hzl_ServerGroupConfig_t struct to avoid unexpected paddings. </p>

</div>
</div>
<a id="a5aacb935193864d26375eaf58895975a" name="a5aacb935193864d26375eaf58895975a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aacb935193864d26375eaf58895975a">&#9670;&nbsp;</a></span>_Static_assert() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Static_assert </td>
          <td>(</td>
          <td class="paramtype">sizeof(<a class="el" href="hzl___server_8h.html#a09451717cf530f151361e06b79efd57f">hzl_ServerGroupState_t</a>)&#160;</td>
          <td class="paramname"> = <code>=52</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;The size of the Server Group State struct must be exactly 52 B&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Double-checking the size of the hzl_ServerGroupState_t struct to avoid unexpected paddings. </p>

</div>
</div>
<a id="ad6c587771c0292cb38fa2d6835214606" name="ad6c587771c0292cb38fa2d6835214606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6c587771c0292cb38fa2d6835214606">&#9670;&nbsp;</a></span>hzl_ServerInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a> hzl_ServerInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialisation of the Server. </p>
<p >To be called once before any other function. Checks the configuration thoroughly, initialises the states.</p>
<p >After initialisation, the Server will have all Session information generated and ready to transmit Responses upon Requests and ready to transmit a new Secured message.</p>
<dl class="section warning"><dt>Warning</dt><dd>The Server must be fully initialised before the Clients, otherwise it cannot supply the Session information to them upon Request.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>prepared with the proper structs and function pointers by the user before calling this function. Further initialisation performed by this function. See <a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d" title="Configuration and status of the HazelNet Server library.">hzl_ServerCtx_t</a> for details.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da987be958f061493a9aa216995fd2556b" title="Successful completion of the operation.">HZL_OK</a></td><td>on success.</td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da516d0e8c3428c167f49e0c13b18aded9" title="The function requires a pointer to the Hazelnet context, but NULL was provided.">HZL_ERR_NULL_CTX</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da2320e8efdd5a32e05758117a51ec574f" title="The context contains a NULL pointer to the Server configuration struct.">HZL_ERR_NULL_CONFIG_SERVER</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dab9df62400dc3634bc7b076b865d97d6b" title="The Party configuration contains an unknown or unsupported CBS Header Type.">HZL_ERR_INVALID_HEADER_TYPE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da6f9c945c8db89784ce5f405832c59cb0" title="The Party configuration contains zero Groups.">HZL_ERR_ZERO_GROUPS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11daf6015054240772004423a779decedbf7" title="The party configurations contains an amount of Groups that implies there is at least one Group with a...">HZL_ERR_TOO_MANY_GROUPS_FOR_CONFIGURED_HEADER_TYPE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da3fdc72b1501899a512e5deb801947248" title="The Server configuration contains zero Clients.">HZL_ERR_ZERO_CLIENTS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da5f72b5096e13905d84424e80b1b96378" title="The Server configurations contains an amount of Groups that implies there is at least one Client with...">HZL_ERR_TOO_MANY_CLIENTS_FOR_CONFIGURED_HEADER_TYPE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da6cf8f376e89e65753c9b8ff086984160" title="The context contains a NULL pointer to the array of Client configuration structs.">HZL_ERR_NULL_CONFIG_CLIENTS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da88af3a4b39e5488b2dd96066b0464848" title="The configured Client&#39;s Long Term Key (or at least 1 of them for the Server) is uninitialised,...">HZL_ERR_LTK_IS_ALL_ZEROS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da083ae44262e824d425eda91ec194e26d" title="The Client configuration contains a Source Identifier (SID) equal to the one used by the Server HZL_S...">HZL_ERR_SERVER_SID_ASSIGNED_TO_CLIENT</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dacaea18c9dcbbd9481f1bf8b4d23fce85" title="The array of Client configurations must be sorted from smallest to largest SID without repeated SIDs.">HZL_ERR_SIDS_ARE_NOT_PRESORTED_STRICTLY_ASCENDING</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da0b923e2fa30d67d8d7e6d21ee4769e0a" title="The array of Client configurations must have all SIDs from 1 to hzl_ServerConfig_t....">HZL_ERR_GAP_IN_SIDS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da5d02e72e4fc158bad3d6b53cc032d7f8" title="The context contains a NULL pointer to the Client configuration struct (on a Client) or array of (on ...">HZL_ERR_NULL_CONFIG_GROUPS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da350013ef58f6e2e9a64c472462a1047e" title="The array of Group configurations must be sorted from smallest to largest GID without repeated GIDs.">HZL_ERR_GIDS_ARE_NOT_PRESORTED_STRICTLY_ASCENDING</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11daa5c6a0784a126104f6f3a12557bcbf84" title="The array of Group configurations must contain all GIDs from 0 to hzl_ServerConfig_t....">HZL_ERR_GAP_IN_GIDS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da81dd92d6bfa3a0a5d19500d939c613ba" title="The array of Group configurations must have the GID == 0 (broadcast Group) HZL_BROADCAST_GID.">HZL_ERR_MISSING_GID_0</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dad10db55c152ef050630adcea673ac9a6" title="The array of Group configuration has at least one Group where the max Counter Nonce Delay field is ou...">HZL_ERR_INVALID_MAX_CTRNONCE_DELAY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da56958e5541b0c412671095f60dd773ac" title="The Server-side array of Group configuration has at least one Group where the Counter Nonce upper lim...">HZL_ERR_TOO_LARGE_CTRNONCE_UPPER_LIMIT</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da74d700891fa1328cc34e107bbf372a5b" title="The Server-side array of Group configuration has at least one Group where the delay between successiv...">HZL_ERR_INVALID_DELAY_BETWEEN_REN_NOTIFICATIONS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da1ed0a86bc3f5fde63e0b1bb671b6e7bf" title="The Server-side array of Group configuration has at least one Group where the bitmap of Clients in th...">HZL_ERR_CLIENTS_BITMAP_ZERO_CLIENTS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da8a3472121b8961f4de2b928a4b6bca2b" title="The Server-side array of Group configuration has at least one Group where the bitmap of Clients in th...">HZL_ERR_CLIENTS_BITMAP_UNKNOWN_SID</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dabfeaa5bb7799d75a5b9a4391b6ea4566" title="The Server-side array of Group configuration has the broadcast Group with GID == HZL_BROADCAST_GID th...">HZL_ERR_CLIENTS_BITMAP_INVALID_BROADCAST_GROUP</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11daf395704472e82abcf9da61364637c180" title="The context contains a NULL pointer to the Group states array.">HZL_ERR_NULL_STATES_GROUPS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da96dd370b982e0a119350e81b8d990556" title="The function pointer to the timestamping function is NULL.">HZL_ERR_NULL_CURRENT_TIME_FUNC</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da04006e9921c17bff199520c1dfd1a37f" title="The function pointer to the true-random number generating function is NULL.">HZL_ERR_NULL_TRNG_FUNC</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da8bed0e8e5b75bc4521faba1c1a3f928b" title="The timestamping function failed to provide the current time.">HZL_ERR_CANNOT_GET_CURRENT_TIME</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dade7290f7890a407a4308d3c2dd387d2c" title="The true-random number generation function failed to provide a random number.">HZL_ERR_CANNOT_GENERATE_RANDOM</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da666519009f7d749f5b4dbc656eb527d5" title="The true-random number generation failed to provide a non-zero arrays of bytes for too many times in ...">HZL_ERR_CANNOT_GENERATE_NON_ZERO_RANDOM</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6f9bffd4349f880158021439c0d3e7e2" name="a6f9bffd4349f880158021439c0d3e7e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f9bffd4349f880158021439c0d3e7e2">&#9670;&nbsp;</a></span>hzl_ServerDeInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a> hzl_ServerDeInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deinitialisation of the Server, securely clearing the state. </p>
<p >To be called after the Server is not used anymore or before entering a low-power mode.</p>
<p >Other fields of the context are untouched (configuration and IO functions), so the context may be reused for another <a class="el" href="hzl___server_8h.html#ad6c587771c0292cb38fa2d6835214606" title="Initialisation of the Server.">hzl_ServerInit()</a> call after the deinitialisation.</p>
<dl class="section warning"><dt>Warning</dt><dd>Deinitialising the Server means that no Client will be able to obtain the current session information, effectively preventing handshakes and thus secure communication. Be sure to run it only when the Server is really not in use anymore by any Client.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>context with state to clear. Not NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da987be958f061493a9aa216995fd2556b" title="Successful completion of the operation.">HZL_OK</a></td><td>on success. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da516d0e8c3428c167f49e0c13b18aded9" title="The function requires a pointer to the Hazelnet context, but NULL was provided.">HZL_ERR_NULL_CTX</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da2320e8efdd5a32e05758117a51ec574f" title="The context contains a NULL pointer to the Server configuration struct.">HZL_ERR_NULL_CONFIG_SERVER</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11daf395704472e82abcf9da61364637c180" title="The context contains a NULL pointer to the Group states array.">HZL_ERR_NULL_STATES_GROUPS</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae3e5fb9ed6ac5a553682864970803bfb" name="ae3e5fb9ed6ac5a553682864970803bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3e5fb9ed6ac5a553682864970803bfb">&#9670;&nbsp;</a></span>hzl_ServerBuildUnsecured()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a> hzl_ServerBuildUnsecured </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *&#160;</td>
          <td class="paramname"><em>unsecuredPdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>userData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>userDataLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a5141d0db3abd7f536c3e4c428b51a273">hzl_Gid_t</a>&#160;</td>
          <td class="paramname"><em>groupId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds an <b>unsecured</b> message in plaintext. </p>
<p >This message may be transmitted at <b>any point in time</b>, as long as the context is initialised. This means even before or during a handshake for the given Group.</p>
<p >The message may be built and transmitted **even if the <code>group</code> does not exist** in the configuration. This is allowed in order to communicate with some devices that don't have a preconfigured Group in common with this one. No error is raised.</p>
<dl class="section warning"><dt>Warning</dt><dd>Use it only on data that was already secured by other means by the application or for debugging purposes. The usage of this type of message to transmit plaintext data is strongly discouraged.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">unsecuredPdu</td><td>UAD message in packed format, ready to transmit. Not NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>just to access configurations and functions. No change in the state. Not NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">userData</td><td>plaintext data (SDU) to pack not-obfuscated, not-authenticated. Can be NULL only if <code>userDataLen</code> is zero. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">userDataLen</td><td>length of <code>userData</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">groupId</td><td>destination group identifier (expected receivers). It may also be a GID <b>not</b> listed in the context's configuration.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da987be958f061493a9aa216995fd2556b" title="Successful completion of the operation.">HZL_OK</a></td><td>on success. </td></tr>
    <tr><td class="paramname">Same</td><td>values as <a class="el" href="hzl___server_8h.html#ad6c587771c0292cb38fa2d6835214606" title="Initialisation of the Server.">hzl_ServerInit()</a> in case the context has NULL pointers. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da9cc853977b60a5049a33c774f8656c1a" title="The pointer to the Protocol Data Unit (packed CBS message) to transmit or the just-received one is NU...">HZL_ERR_NULL_PDU</a></td><td>if <code>unsecuredPdu</code> is NULL. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da22954ba624fda32655cd3b5e345fb34c" title="The pointer to the Service Data Unit (unpacked user data) to transmit or the just-received one is NUL...">HZL_ERR_NULL_SDU</a></td><td>if <code>userData</code> is NULL and <code>userDataLen</code> is &gt; 0. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da667d0e6a83fc1de843335fb39b08801e" title="The user-provided data to be transmitted is too long to fit into the specified message type.">HZL_ERR_TOO_LONG_SDU</a></td><td>if <code>userDataLen</code> is too large for the underlying PDU. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da8e6aa080ccdde8afbac75ebad80e5779" title="The array of Group configurations has at least one Group with a GID value that would not fit into the...">HZL_ERR_GID_TOO_LARGE_FOR_CONFIGURED_HEADER_TYPE</a></td><td>when <code>groupId</code> would not fit in the packed CBS header. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a86ad407a9d8e58dfe6f32e9eff4188f3" name="a86ad407a9d8e58dfe6f32e9eff4188f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86ad407a9d8e58dfe6f32e9eff4188f3">&#9670;&nbsp;</a></span>hzl_ServerBuildSecuredFd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a> hzl_ServerBuildSecuredFd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *&#160;</td>
          <td class="paramname"><em>securedPdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>userData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>userDataLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a5141d0db3abd7f536c3e4c428b51a273">hzl_Gid_t</a>&#160;</td>
          <td class="paramname"><em>groupId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds a secured message, encrypted, authenticated and timely, only for the given group to be able to read. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">securedPdu</td><td>CBS message in packed format, ready to transmit. Not NULL. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>to access configurations and update the group states. Not NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">userData</td><td>plaintext data (SDU) to pack encrypted and authenticated. Can be NULL only if <code>userDataLen</code> is zero. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">userDataLen</td><td>length of <code>userData</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">groupId</td><td>destination group identifier (the Parties that can decrypt).</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da987be958f061493a9aa216995fd2556b" title="Successful completion of the operation.">HZL_OK</a></td><td>on successful building of the Secured Application Data. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dab0f13149659e9d9b044d351f2fd35792" title="The building of the Secured Application Data or a Session Renewal Notification could not be performed...">HZL_ERR_NO_POTENTIAL_RECEIVER</a></td><td>if no Request was received yet from any Client in the requested Group <code>groupId</code>. If transmitted, the message could not be decrypted by anyone, because no Client has yet the Session information. </td></tr>
    <tr><td class="paramname">Same</td><td>values as <a class="el" href="hzl___server_8h.html#ad6c587771c0292cb38fa2d6835214606" title="Initialisation of the Server.">hzl_ServerInit()</a> in case the context has NULL pointers. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da9cc853977b60a5049a33c774f8656c1a" title="The pointer to the Protocol Data Unit (packed CBS message) to transmit or the just-received one is NU...">HZL_ERR_NULL_PDU</a></td><td>if <code>securedPdu</code> is NULL. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da22954ba624fda32655cd3b5e345fb34c" title="The pointer to the Service Data Unit (unpacked user data) to transmit or the just-received one is NUL...">HZL_ERR_NULL_SDU</a></td><td>if <code>userData</code> is NULL and <code>userDataLen</code> is &gt; 0. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da667d0e6a83fc1de843335fb39b08801e" title="The user-provided data to be transmitted is too long to fit into the specified message type.">HZL_ERR_TOO_LONG_SDU</a></td><td>if <code>userDataLen</code> is too large for the underlying PDU. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da8e6aa080ccdde8afbac75ebad80e5779" title="The array of Group configurations has at least one Group with a GID value that would not fit into the...">HZL_ERR_GID_TOO_LARGE_FOR_CONFIGURED_HEADER_TYPE</a></td><td>when <code>groupId</code> would not fit in the packed CBS header. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dace2411f8131f5267996e4602e93c42c7" title="The user-specified Group (GID) for transmission or the received message&#39;s GID field indicate a Group ...">HZL_ERR_UNKNOWN_GROUP</a></td><td>when <code>group</code> is not supported in the context's configuration. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dade7290f7890a407a4308d3c2dd387d2c" title="The true-random number generation function failed to provide a random number.">HZL_ERR_CANNOT_GENERATE_RANDOM</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da666519009f7d749f5b4dbc656eb527d5" title="The true-random number generation failed to provide a non-zero arrays of bytes for too many times in ...">HZL_ERR_CANNOT_GENERATE_NON_ZERO_RANDOM</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da8bed0e8e5b75bc4521faba1c1a3f928b" title="The timestamping function failed to provide the current time.">HZL_ERR_CANNOT_GET_CURRENT_TIME</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2ea102344d4a13318c430db13c076dd3" name="a2ea102344d4a13318c430db13c076dd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ea102344d4a13318c430db13c076dd3">&#9670;&nbsp;</a></span>hzl_ServerProcessReceived()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a> hzl_ServerProcessReceived </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *&#160;</td>
          <td class="paramname"><em>reactionPdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a4e9184780d6e2bb480b7e0e4756517d7">hzl_RxSduMsg_t</a> *&#160;</td>
          <td class="paramname"><em>receivedUserData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>receivedPdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>receivedPduLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a4d223ec636e15110f4bdfcc4eac20f91">hzl_CanId_t</a>&#160;</td>
          <td class="paramname"><em>receivedCanId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates, unpacks and decrypts (if necessary) any received message, preparing an automatic response when required. </p>
<p >Handles automatically messages of different types, making a variety of checks for the correctness, integrity, authenticity of the message (note: the latter is not guaranteed for Unsecured messages). Updates the internal state automatically to keep track of the changing nonces and Session states.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">reactionPdu</td><td>CBS message in packed format, ready to transmit, generated as an automatic, internal reaction to the just received message. No need to transmit if <a class="el" href="structhzl___cbs_pdu_msg.html#a130324203ba2e5065fcbb4bdc55bc81d" title="Length in bytes of the CBS-Payload.">hzl_CbsPduMsg_t.dataLen</a> is zero. Not NULL. <b>Transmit any data even if the return error code is non-OK.</b> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">receivedUserData</td><td>plaintext user data extracted out of <code>receivedPdu</code>. If the processed message contained no user data (was an internal message), the field <a class="el" href="structhzl___rx_msg.html#aee7df759764a08b9d11f24b933cf79db" title="True if the message contains useful data for the user, false if internal.">hzl_RxSduMsg_t.isForUser</a> is false. The whole struct is securely cleared (zeroed out) before anything else is attempted; thus it's full of zeros in case of errors. This is done to clear any lingering data if the buffer is reused, to avoid leaking information about previously-decrypted messages. Not NULL. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>to access configurations and update the group states. Not NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">receivedPdu</td><td>packed CBS message as received from the underlying layer. Not NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">receivedPduLen</td><td>length of <code>receivedPdu</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">receivedCanId</td><td>identifier of the underlying layer's PDU, passed as-is to <code>receivedUserData</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da987be958f061493a9aa216995fd2556b" title="Successful completion of the operation.">HZL_OK</a></td><td>on success. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dab3d274e6b7c9fe05b6313168e0c67676" title="The received message is ignored as it&#39;s not addressed to this Party or is redundant.">HZL_ERR_MSG_IGNORED</a></td><td>when the message has another destination. </td></tr>
    <tr><td class="paramname">Same</td><td>values as <a class="el" href="hzl___server_8h.html#ad6c587771c0292cb38fa2d6835214606" title="Initialisation of the Server.">hzl_ServerInit()</a> in case the context has NULL pointers. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da9cc853977b60a5049a33c774f8656c1a" title="The pointer to the Protocol Data Unit (packed CBS message) to transmit or the just-received one is NU...">HZL_ERR_NULL_PDU</a></td><td>if <code>receivedUserData</code> or <code>receivedPduLen</code> are NULL. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da22954ba624fda32655cd3b5e345fb34c" title="The pointer to the Service Data Unit (unpacked user data) to transmit or the just-received one is NUL...">HZL_ERR_NULL_SDU</a></td><td>if <code>userData</code> is NULL. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dabcb35d7673ad64171bc1d013d73ae647" title="The received message is too short to even contain the CBS header.">HZL_ERR_TOO_SHORT_PDU_TO_CONTAIN_HEADER</a></td><td>when the <code>canFdMsg-&gt;dataLen</code> is too short to even contain a CBS message with the currently configured Header Type in the ctx. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11daf4946ab48f608c07a269898f17682e81" title="The received message contains an unknown PTY field.">HZL_ERR_INVALID_PAYLOAD_TYPE</a></td><td>on unsupported PTY field in the CBS Header. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dad04eb07277a527be3ca36d7068480a99" title="The received Secured Application Data over CAN FD (SADFD) message is too short to be a valid SADFD me...">HZL_ERR_TOO_SHORT_PDU_TO_CONTAIN_SADFD</a>,<a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da1ca2d7464e17cc5d66edc47398113999" title="The received Request (REQ) message is too short to be a valid REQ message.">HZL_ERR_TOO_SHORT_PDU_TO_CONTAIN_REQ</a></td><td>when the received message is too short to contain the data is should as indicated in its header (or also in the payload length field in case of Secured Application Data messages). </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da2aa841065a0e21dccb3e528b0484657f" title="The received Secured Application Data contains a too large value in the plaintext length field,...">HZL_ERR_TOO_LONG_CIPHERTEXT</a></td><td>if the received Secured Application Data message claims to contain too much data to fit into the underlying layer's message. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11daeb9c8c1159462993b574ce39ae49dccf" title="The Group the message is addressed to has no valid Session information in the local state.">HZL_ERR_SESSION_NOT_ESTABLISHED</a></td><td>when the current state indicates no session key and counter nonce have been established for this group yet. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da14bcf255ada78d9e0213b09448288a67" title="Received message contained the receiver&#39;s Source Identfi&#x241C;er as the transmitter&#39;s identity.">HZL_ERR_SECWARN_MESSAGE_FROM_MYSELF</a></td><td>when the received message seems to originate from the receiver itself. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da399c0c5431470f0288915b1f503c44f6" title="Received message is of a type which only the Session Server can transmit, but the transmitter&#39;s ident...">HZL_ERR_SECWARN_SERVER_ONLY_MESSAGE</a></td><td>when the received message that can only be sent by the server </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da31d18bc93d7a6547ec90d8af872fdfee" title="Received message contained a Counter Nonce that exceeded its maximum allowed value.">HZL_ERR_SECWARN_RECEIVED_OVERFLOWN_NONCE</a></td><td>if the received nonce is overflown </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dac7b14a62a1c555cc83c319688affe101" title="Received message contained a too-old counter nonce.">HZL_ERR_SECWARN_OLD_MESSAGE</a></td><td>if the received nonce is old, indicating a potential replay attack </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da808b280f5e46d4fc5804aef4642ff14c" title="Received message is not intact or not authentic or does not use the proper values in the hashing/auth...">HZL_ERR_SECWARN_INVALID_TAG</a></td><td>when the message integrity and authenticity cannot be guaranteed </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dade7290f7890a407a4308d3c2dd387d2c" title="The true-random number generation function failed to provide a random number.">HZL_ERR_CANNOT_GENERATE_RANDOM</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da666519009f7d749f5b4dbc656eb527d5" title="The true-random number generation failed to provide a non-zero arrays of bytes for too many times in ...">HZL_ERR_CANNOT_GENERATE_NON_ZERO_RANDOM</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da8bed0e8e5b75bc4521faba1c1a3f928b" title="The timestamping function failed to provide the current time.">HZL_ERR_CANNOT_GET_CURRENT_TIME</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afcdeb8319fbe3b5368ca80293a995e95" name="afcdeb8319fbe3b5368ca80293a995e95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcdeb8319fbe3b5368ca80293a995e95">&#9670;&nbsp;</a></span>hzl_ServerForceSessionRenewal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="hzl_8h.html#a625a0679f289e7ca5c747a78e5101b87">HZL_API</a> <a class="el" href="hzl_8h.html#a992c5466a30f9bf40204cfc5bd8a8bec">hzl_Err_t</a> hzl_ServerForceSessionRenewal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a6e136aa15a3fa6d1ae6ade363b0b518c">hzl_CbsPduMsg_t</a> *&#160;</td>
          <td class="paramname"><em>renewalPdu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl___server_8h.html#a227238d51b4c16b337df65ea1fad1d0d">hzl_ServerCtx_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hzl_8h.html#a5141d0db3abd7f536c3e4c428b51a273">hzl_Gid_t</a>&#160;</td>
          <td class="paramname"><em>groupId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forcibly start a Session Renewal Phase, unless one is already ongoing or no Clients are currently enabled (have Requested the STK) to process the REN message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">renewalPdu</td><td>REN message in packed format, ready to transmit. Not NULL. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>to access configurations and update the group states. Not NULL. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">groupId</td><td>destination group identifier (the Parties that can decrypt).</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da987be958f061493a9aa216995fd2556b" title="Successful completion of the operation.">HZL_OK</a></td><td>on success. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dab0f13149659e9d9b044d351f2fd35792" title="The building of the Secured Application Data or a Session Renewal Notification could not be performed...">HZL_ERR_NO_POTENTIAL_RECEIVER</a></td><td>if no Request was received yet from any Client in the requested Group <code>groupId</code>. If transmitted, the message could not be validated by anyone, because no Client has yet the Session information. </td></tr>
    <tr><td class="paramname">Same</td><td>values as <a class="el" href="hzl___server_8h.html#ad6c587771c0292cb38fa2d6835214606" title="Initialisation of the Server.">hzl_ServerInit()</a> in case the context has NULL pointers. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da9cc853977b60a5049a33c774f8656c1a" title="The pointer to the Protocol Data Unit (packed CBS message) to transmit or the just-received one is NU...">HZL_ERR_NULL_PDU</a></td><td>if <code>renewalPdu</code> is NULL. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11dace2411f8131f5267996e4602e93c42c7" title="The user-specified Group (GID) for transmission or the received message&#39;s GID field indicate a Group ...">HZL_ERR_UNKNOWN_GROUP</a></td><td>when <code>group</code> is not supported in the context's configuration. </td></tr>
    <tr><td class="paramname"><a class="el" href="hzl_8h.html#a9e46f00210350b247e5ec159e29ec11da8bed0e8e5b75bc4521faba1c1a3f928b" title="The timestamping function failed to provide the current time.">HZL_ERR_CANNOT_GET_CURRENT_TIME</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
